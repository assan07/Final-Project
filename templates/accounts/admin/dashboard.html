<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <link rel="icon" href="{{ url_for('static', filename='images/icon/logo-brand.png') }}" type="image/x-icon" />
    <link rel="shortcut icon" href="{{ url_for('static', filename='images/icon/logo-brand.png') }}" type="image/x-icon" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/data_user.css') }}" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        .sidebar {
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            padding-top: 3.5rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .main-content {
            margin-left: 250px;
            padding: 20px;
        }
        
        .nav-link {
            color: #333;
            padding: 0.8rem 1rem;
            border-radius: 0.25rem;
            margin: 0.2rem 0;
        }
        
        .nav-link:hover {
            background-color: #c7ddf3;
        }
        
        .nav-link.active {
            background-color: #0d6efd;
            color: white;
        }
        
        .stats-card {
            transition: transform 0.2s;
            border-radius: 0.5rem;
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
        }
        
        .navbar-brand {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .bg-blue-dark {
            background-color: #003366;
            color: white;
        }
        
        .bg-blue-medium {
            background-color: #004c99;
            color: white;
        }
        
        .bg-blue-light {
            background-color: #1a75ff;
            color: white;
        }
        
        .bg-blue-lighter {
            background-color: #66a3ff;
            color: white;
        }
        
        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
            line-height: 1.5;
            border-radius: 0.2rem;
            height: auto;
            display: inline-flex;
            align-items: center;
        }
        
        .btn-danger {
            background-color: #dc3545;
            color: #fff;
            border: none;
        }
        
        .btn i {
            margin-right: 4px;
        }
    </style>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center mx-3">
                <img class="bi me-2" width="40" height="40" src="{{ url_for('static', filename='images/icon/logo-brand.png') }}" alt="Logo brand" />
                <img class="fs-4 bi me-2" width="160" height="40" src="{{ url_for('static', filename='images/icon/logo-title.png') }}" alt="Logo title" />
            </a>
            <div class="d-flex">
                <span class="navbar-text me-3">
            Welcome, {{ session['admin_name'] }}
          </span>
                <a href="{{ url_for('admin_logout') }}" class="btn btn-light btn-m me-3">Logout</a
          >
        </div>
      </div>
    </nav>

    <!-- Sidebar -->
    <div class="sidebar bg-white" style="width: 250px">
      <div
        class="nav flex-column nav-pills p-3"
        role="tablist"
        aria-orientation="vertical"
      >
        <button
          class="nav-link active"
          data-bs-toggle="tab"
          data-bs-target="#dashboard"
          type="button"
          role="tab"
        >
          Dashboard
        </button>
        <button
          class="nav-link"
          data-bs-toggle="tab"
          data-bs-target="#dataBarang"
          type="button"
          role="tab"
        >
          Data Barang
        </button>
        <button
          class="nav-link"
          data-bs-toggle="tab"
          data-bs-target="#dataUser"
          type="button"
          role="tab"
        >
          Data User
        </button>
        <button
          class="nav-link"
          data-bs-toggle="tab"
          data-bs-target="#dataAdmin"
          type="button"
          role="tab"
        >
          Data Admin
        </button>
      </div>
    </div>

    <!-- Main Content with Tabs -->
    <div class="main-content">
      <div class="tab-content">
        <div class="tab-pane fade show active" id="dashboard" role="tabpanel">
          <div class="row mb-4 mt-lg-5 pt-5">
            <!-- Total Users -->
            <div class="col-md-3">
              <div class="card stats-card bg-blue-dark text-white">
                <div class="card-body">
                  <h5 class="card-title">Total Users</h5>
                  <h2 class="card-text">{{ total_users }}</h2>
                </div>
              </div>
            </div>
            <!-- Total Admin -->
            <div class="col-md-3">
              <div class="card stats-card bg-blue-medium text-white">
                <div class="card-body">
                  <h5 class="card-title">Total Admin</h5>
                  <h2 class="card-text">{{ total_admin }}</h2>
                </div>
              </div>
            </div>
            <!-- Total Barang -->
            <div class="col-md-3">
              <div class="card stats-card bg-blue-light text-white">
                <div class="card-body">
                  <h5 class="card-title">Total Barang</h5>
                  <h2 class="card-text">{{ total_barang }}</h2>
                </div>
              </div>
            </div>
            <!-- Total Transaksi -->
            <div class="col-md-3">
              <div class="card stats-card bg-blue-lighter text-white">
                <div class="card-body">
                  <h5 class="card-title">Total Transaksi</h5>
                  <h2 class="card-text">{{ total_transaksi }}</h2>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Recent Activity -->
        <div class="card mt-5">
          <div class="card-header">
            <h5 class="card-title mb-0">Recent Activity</h5>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Tanggal</th>
                    <th>User</th>
                    <th>Aktivitas</th>
                  </tr>
                </thead>
                <tbody>
                  {% for activity in recent_activities %}
                  <tr>
                    <td>{{ activity.date }}</td>
                    <td>{{ activity.user }}</td>
                    <td>{{ activity.action }}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Data Barang Tab -->
        <div class="tab-pane fade" id="dataBarang" role="tabpanel">
          <div class="container mt-4">
            <div class="card mt-4">
              <div class="card-body">
                <h2 class="card-title">DATA BARANG</h2>

                <!-- Search Bar for Data Barang -->
                <div class="d-flex justify-content-end mb-3">
                  <input
                    type="text"
                    class="form-control w-25 me-2"
                    id="searchInputBarang"
                    placeholder="Search Barang"
                  />
                  <button class="btn btn-dark" id="searchButtonBarang">
                    Search
                  </button>
                  <button
                    id="tambahBtn"
                    type="button"
                    class="btn btn-danger mx-2"
                  >
                    Tambah Barang
                  </button>
                </div>

                <!-- Table -->
                <div class="table-responsive">
                  <table class="table table-bordered text-center">
                    <thead class="table-secondary">
                      <tr>
                        <th>No.</th>
                        <th>Kategori</th>
                        <th>Brand</th>
                        <th>Netto</th>
                        <th>Warna</th>
                        <th>Harga</th>
                        <th>Stok</th>
                        <th>Image</th>
                        <th>Aksi</th>
                      </tr>
                    </thead>
                    <tbody id="barangTableBody">
                      {% for barang in barang_data %}
                      <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ barang.kategori }}</td>
                        <td>{{ barang.brand }}</td>
                        <td>{{ barang.netto }}</td>
                        <td>{{ barang.warna }}</td>
                        <td>{{ barang.harga }}</td>
                        <td>{{ barang.stock }}</td>
                        <td>
                          {% if barang.foto %}
                          <img
                            src="{{ url_for('static', filename='images/gambar_barang/' + barang.foto) }}"
                            alt="Foto Barang"
                            width="70"
                            height="50"
                          />
                          {% else %} No Image {% endif %}
                        </td>
                        <td>
                          <button
                            class="btn btn-danger btn-sm delete-btn"
                            type="button"
                            data-id="{{ barang._id }}"
                          >
                            <i class="fa fa-trash"></i> Delete
                          </button>
                          <button
                            class="btn btn-danger btn-sm edit-btn"
                            type="button"
                            data-id="{{ barang._id }}"
                            data-kategori="{{ barang.kategori }}"
                            data-brand="{{ barang.brand }}"
                            data-netto="{{ barang.netto }}"
                            data-warna="{{ barang.warna }}"
                            data-harga="{{ barang.harga }}"
                            data-stock="{{ barang.stock }}"
                            data-foto="{{ barang.foto }}"
                          >
                            <i class="fa fa-edit"></i> Edit
                          </button>
                        </td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Form Tambah Barang -->
        <div id="input-box" style="display: none">
          <div class="row g-2 mt-5 border border-2 p-4">
            <div class="col-md-4">
              <label for="inputState" class="form-label">Kategori</label>
              <select id="inputState" class="form-select">
                <option selected>Choose...</option>
                <option>CAT</option>
                <option>TINNER</option>
                <option>AKSESORIS PVC</option>
              </select>
            </div>
            <div class="mb-2 col-md-4">
              <label for="InputBrand" class="form-label">Brand</label>
              <input
                type="text"
                class="form-control"
                id="brand"
                placeholder="Brand Name"
              />
            </div>
            <div class="col-md-4">
              <label for="InputNetto" class="form-label">Netto</label>
              <input
                type="text"
                class="form-control"
                id="netto"
                placeholder="Netto Product"
              />
            </div>
            <div class="col-md-4">
              <label for="inputWarna" class="form-label">Warna</label>
              <input
                type="text"
                class="form-control"
                id="warna"
                placeholder="Warna Product"
              />
            </div>
            <div class="col-md-4">
              <label for="inputHarga" class="form-label">Harga</label>
              <input
                type="text"
                class="form-control"
                id="harga"
                placeholder="Harga Product"
              />
            </div>
            <div class="col-md-4">
              <label for="inputStock" class="form-label">Stock</label>
              <input
                type="text"
                class="form-control"
                id="stock"
                placeholder="Stock Product"
              />
            </div>
            <div class="col-md-12">
              <label for="formFileMultiple" class="form-label"
                >Foto Product</label
              >
              <input class="form-control" type="file" id="foto" multiple />
            </div>
            <div class="mt-4 col-12">
              <button id="submitSimpanBarang" class="btn btn-primary">
                Simpan
              </button>
            </div>
          </div>
        </div>

        <!-- Form Edit Barang -->
        <div id="edit-box" style="display: none">
          <div class="row g-2 mt-5 border border-2 p-4">
            <div class="col-md-4">
              <label for="editKategori" class="form-label">Kategori</label>
              <select id="editKategori" class="form-select">
                <option selected>Choose...</option>
                <option>CAT</option>
                <option>TINNER</option>
                <option>AKSESORIS PVC</option>
              </select>
            </div>
            <div class="mb-2 col-md-4">
              <label for="editBrand" class="form-label">Brand</label>
              <input
                type="text"
                class="form-control"
                id="editBrand"
                placeholder="Brand Name"
              />
            </div>
            <div class="col-md-4">
              <label for="editNetto" class="form-label">Netto</label>
              <input
                type="text"
                class="form-control"
                id="editNetto"
                placeholder="Netto Product"
              />
            </div>
            <div class="col-md-4">
              <label for="editWarna" class="form-label">Warna</label>
              <input
                type="text"
                class="form-control"
                id="editWarna"
                placeholder="Warna Product"
              />
            </div>
            <div class="col-md-4">
              <label for="editHarga" class="form-label">Harga</label>
              <input
                type="text"
                class="form-control"
                id="editHarga"
                placeholder="Harga Product"
              />
            </div>
            <div class="col-md-4">
              <label for="editStock" class="form-label">Stock</label>
              <input
                type="text"
                class="form-control"
                id="editStock"
                placeholder="Stock Product"
              />
            </div>
            <div class="col-md-12">
              <label for="editFoto" class="form-label">Foto Product</label>
              <input class="form-control" type="file" id="editFoto" />
            </div>
            <div class="mt-4 col-12">
              <button id="submitEditBarang" class="btn btn-primary">
                Simpan Perubahan
              </button>
            </div>
          </div>
        </div>

        <!-- Data User Tab -->
        <div class="tab-pane fade" id="dataUser" role="tabpanel">
          <div class="container mt-4">
            <div class="card mt-4">
              <div class="card-body">
                <h2 class="card-title">DATA USER</h2>

                <!-- Search Bar for Data User -->
                <div class="d-flex justify-content-end mb-3">
                  <input
                    type="text"
                    class="form-control w-25 me-2"
                    id="searchInputUser"
                    placeholder="Search User"
                  />
                  <button class="btn btn-dark" id="searchButtonUser">
                    Search
                  </button>
                </div>

                <!-- Tabel Data User -->
                <div class="table-responsive">
                  <table class="table table-bordered text-center">
                    <thead class="table-secondary">
                      <tr>
                        <th>No.</th>
                        <th>Nama</th>
                        <th>Email</th>
                        <th>Password</th>
                        <th>Aksi</th>
                      </tr>
                    </thead>
                    <tbody id="userTableBody">
                      {% for user in data_user %}
                      <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ user.full_name }}</td>
                        <td>{{ user.email }}</td>
                        <td>*****</td>
                        <td>
                          <!-- Tombol Delete untuk Data User -->
                          <button
                            class="btn btn-danger btn-sm delete-btn"
                            type="button"
                            data-id="{{ user._id }}"
                          >
                            <i class="fa fa-trash"></i> Delete
                          </button>
                        </td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Data Admin -->
        <div class="tab-pane fade" id="dataAdmin" role="tabpanel">
          <div class="container mt-4">
            <div class="card mt-4">
              <div class="card-body">
                <h2 class="card-title">DATA ADMIN</h2>

                <!-- Search Bar for Data Admin -->
                <div class="d-flex justify-content-end mb-3">
                  <input
                    type="text"
                    class="form-control w-25 me-2"
                    id="searchInputAdmin"
                    placeholder="Search Admin"
                  />
                  <button class="btn btn-dark" id="searchButtonAdmin">
                    Search
                  </button>
                </div>

                <!-- Tabel Data Admin -->
                <div class="table-responsive">
                  <table class="table table-bordered text-center">
                    <thead class="table-secondary">
                      <tr>
                        <th>No.</th>
                        <th>Username</th>
                        <th>Email</th>
                        <th>Password</th>
                        <th>Aksi</th>
                      </tr>
                    </thead>
                    <tbody id="adminTableBody">
                      {% for admin in data_admin %}
                      <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ admin.username }}</td>
                        <td>{{ admin.email }}</td>
                        <td>*****</td>
                        <td>
                          <!-- Tombol Delete untuk Data Admin -->
                          <button
                            class="btn btn-danger btn-sm delete-btn"
                            type="button"
                            data-id="{{ admin._id }}"
                          >
                            <i class="fa fa-trash"></i> Delete
                          </button>
                        </td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script>
      // Fungsi untuk mencari Data Barang
      document
        .getElementById("searchButtonBarang")
        .addEventListener("click", function () {
          var input = document
            .getElementById("searchInputBarang")
            .value.toLowerCase(); // Ambil nilai pencarian
          var table = document.querySelector("#barangTableBody"); // Dapatkan tbody dari tabel barang
          var rows = table.getElementsByTagName("tr"); // Ambil semua baris dalam tabel barang

          // Loop melalui setiap baris tabel dan sembunyikan yang tidak sesuai dengan pencarian
          for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].getElementsByTagName("td"); // Ambil semua sel dalam baris
            var match = false;

            // Loop melalui setiap sel dalam baris untuk mencari kata kunci
            for (var j = 0; j < cells.length; j++) {
              if (cells[j].textContent.toLowerCase().indexOf(input) > -1) {
                match = true;
                break; // Jika ditemukan kecocokan, berhenti mencari di sel lain
              }
            }

            // Menyembunyikan atau menampilkan baris berdasarkan hasil pencarian
            if (match) {
              rows[i].style.display = "";
            } else {
              rows[i].style.display = "none";
            }
          }
        });

      // Fungsi untuk mencari Data User
      document
        .getElementById("searchButtonUser")
        .addEventListener("click", function () {
          var input = document
            .getElementById("searchInputUser")
            .value.toLowerCase(); // Ambil nilai pencarian
          var table = document.getElementById("userTableBody"); // Dapatkan tbody dari tabel user
          var rows = table.getElementsByTagName("tr"); // Ambil semua baris dalam tabel user

          // Loop melalui setiap baris tabel dan sembunyikan yang tidak sesuai dengan pencarian
          for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].getElementsByTagName("td"); // Ambil semua sel dalam baris
            var match = false;

            // Loop melalui setiap sel dalam baris untuk mencari kata kunci
            for (var j = 0; j < cells.length; j++) {
              if (cells[j].textContent.toLowerCase().indexOf(input) > -1) {
                match = true;
                break; // Jika ditemukan kecocokan, berhenti mencari di sel lain
              }
            }

            // Menyembunyikan atau menampilkan baris berdasarkan hasil pencarian
            if (match) {
              rows[i].style.display = ""; // Tampilkan baris
            } else {
              rows[i].style.display = "none"; // Sembunyikan baris
            }
          }
        });

      // Fungsi untuk mencari Data Admin
      document
        .getElementById("searchButtonAdmin")
        .addEventListener("click", function () {
          var input = document
            .getElementById("searchInputAdmin")
            .value.toLowerCase(); // Ambil nilai pencarian
          var table = document.getElementById("adminTableBody"); // Dapatkan tbody dari tabel admin
          var rows = table.getElementsByTagName("tr"); // Ambil semua baris dalam tabel admin

          // Loop melalui setiap baris tabel dan sembunyikan yang tidak sesuai dengan pencarian
          for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].getElementsByTagName("td"); // Ambil semua sel dalam baris
            var match = false;

            // Loop melalui setiap sel dalam baris untuk mencari kata kunci
            for (var j = 0; j < cells.length; j++) {
              if (cells[j].textContent.toLowerCase().indexOf(input) > -1) {
                match = true;
                break; // Jika ditemukan kecocokan, berhenti mencari di sel lain
              }
            }

            // Menyembunyikan atau menampilkan baris berdasarkan hasil pencarian
            if (match) {
              rows[i].style.display = ""; // Tampilkan baris
            } else {
              rows[i].style.display = "none"; // Sembunyikan baris
            }
          }
        });

      // Tampilkan input form
      document
        .getElementById("tambahBtn")
        .addEventListener("click", function () {
          document.getElementById("input-box").style.display = "block";
        });

      // Menambahkan barang baru ke dalam database
      document
        .getElementById("submitSimpanBarang")
        .addEventListener("click", function () {
          var kategori = document.getElementById("inputState").value;
          var brand = document.getElementById("brand").value;
          var netto = document.getElementById("netto").value;
          var warna = document.getElementById("warna").value;
          var harga = document.getElementById("harga").value;
          var stock = document.getElementById("stock").value;
          var foto = document.getElementById("foto").files[0]; // Ambil file foto

          if (!kategori || !brand || !netto || !warna || !harga || !stock) {
            alert("Semua kolom harus diisi!");
            return;
          }

          // Buat FormData untuk mengirim data termasuk file gambar
          var formData = new FormData();
          formData.append("kategori", kategori);
          formData.append("brand", brand);
          formData.append("netto", netto);
          formData.append("warna", warna);
          formData.append("harga", harga);
          formData.append("stock", stock);
          if (foto) {
            formData.append("foto", foto);
          }

          // Kirim data menggunakan AJAX
          $.ajax({
            url: "/accounts/admin/data_barang/tambah_barang",
            type: "POST",
            data: formData,
            processData: false, // Jangan memproses data sebagai string
            contentType: false, // Biarkan jQuery mengatur content type sesuai kebutuhan
            success: function (response) {
              alert("Barang berhasil disimpan");
              location.reload();
            },
            error: function () {
              alert("Terjadi kesalahan. Silakan coba lagi...");
            },
          });
        });

      // Delete Barang
      $(document).ready(function () {
        // Event listener untuk tombol delete
        $("#barangTableBody").on("click", ".delete-btn", function () {
          const barangId = $(this).data("id");

          // Tampilkan dialog konfirmasi
          const confirmation = confirm("Anda yakin akan menghapus barang ini?");
          if (confirmation) {
            // Kirim permintaan DELETE menggunakan AJAX
            $.ajax({
              url: "/accounts/admin/data_barang/delete_barang",
              type: "POST",
              data: {
                id: barangId,
              },
              success: function (response) {
                if (response.status === "success") {
                  alert(response.message);

                  // Hapus baris barang dari tabel
                  $(
                    `#barangTableBody tr:has(td button[data-id='${barangId}'])`
                  ).remove();

                  // Perbarui nomor urut secara dinamis
                  $("#barangTableBody tr").each(function (index) {
                    $(this)
                      .find("td:first")
                      .text(index + 1);
                  });
                } else {
                  alert("Gagal menghapus data.");
                }
              },
              error: function () {
                alert("Terjadi kesalahan pada server.");
              },
            });
          }
        });
      });

      // Delete user
      $(document).ready(function () {
        // Event listener untuk tombol delete
        $("#userTableBody").on("click", ".delete-btn", function () {
          const userId = $(this).data("id");

          // Tampilkan dialog konfirmasi
          const confirmation = confirm("Anda yakin akan menghapus user ini?");
          if (confirmation) {
            // Kirim permintaan DELETE menggunakan AJAX
            $.ajax({
              url: "/accounts/admin/data_user/delete_user",
              type: "POST",
              data: {
                id: userId,
              },
              success: function (response) {
                if (response.status === "success") {
                  alert(response.message);

                  // Hapus baris user dari tabel
                  $(
                    `#userTableBody tr:has(td button[data-id='${userId}'])`
                  ).remove();

                  // Perbarui nomor urut secara dinamis
                  $("#userTableBody tr").each(function (index) {
                    $(this)
                      .find("td:first")
                      .text(index + 1);
                  });
                } else {
                  alert("Gagal menghapus data.");
                }
              },
              error: function () {
                alert("Terjadi kesalahan pada server.");
              },
            });
          }
        });
      });

      // Delete admin
      $(document).ready(function () {
        // Event listener untuk tombol delete
        $("#adminTableBody").on("click", ".delete-btn", function () {
          const adminId = $(this).data("id");

          // Tampilkan dialog konfirmasi
          const confirmation = confirm("Anda yakin akan menghapus admin ini?");
          if (confirmation) {
            // Kirim permintaan DELETE menggunakan AJAX
            $.ajax({
              url: "/accounts/admin/data_admin/delete_admin",
              type: "POST",
              data: {
                id: adminId,
              },
              success: function (response) {
                if (response.status === "success") {
                  alert(response.message);

                  // Hapus baris admin dari tabel
                  $(
                    `#adminTableBody tr:has(td button[data-id='${adminId}'])`
                  ).remove();

                  // Perbarui nomor urut secara dinamis
                  $("#adminTableBody tr").each(function (index) {
                    $(this)
                      .find("td:first")
                      .text(index + 1);
                  });
                } else {
                  alert("Gagal menghapus data.");
                }
              },
              error: function () {
                alert("Terjadi kesalahan pada server.");
              },
            });
          }
        });
      });

      // Menangani klik tombol Edit
      document.querySelectorAll(".edit-btn").forEach(function (button) {
        button.addEventListener("click", function () {
          // Ambil data dari atribut data-* di tombol edit
          var id = button.getAttribute("data-id");
          var kategori = button.getAttribute("data-kategori");
          var brand = button.getAttribute("data-brand");
          var netto = button.getAttribute("data-netto");
          var warna = button.getAttribute("data-warna");
          var harga = button.getAttribute("data-harga");
          var stock = button.getAttribute("data-stock");
          var foto = button.getAttribute("data-foto");

          // Isi form dengan data yang diambil
          document.getElementById("editKategori").value = kategori;
          document.getElementById("editBrand").value = brand;
          document.getElementById("editNetto").value = netto;
          document.getElementById("editWarna").value = warna;
          document.getElementById("editHarga").value = harga;
          document.getElementById("editStock").value = stock;

          // Tampilkan form edit
          document.getElementById("edit-box").style.display = "block";

          // Menangani pengiriman data edit ke server
          document
            .getElementById("submitEditBarang")
            .addEventListener("click", function () {
              var updatedKategori =
                document.getElementById("editKategori").value;
              var updatedBrand = document.getElementById("editBrand").value;
              var updatedNetto = document.getElementById("editNetto").value;
              var updatedWarna = document.getElementById("editWarna").value;
              var updatedHarga = document.getElementById("editHarga").value;
              var updatedStock = document.getElementById("editStock").value;
              var updatedFoto = document.getElementById("editFoto").files[0];

              var formData = new FormData();
              formData.append("id", id);
              formData.append("kategori", updatedKategori);
              formData.append("brand", updatedBrand);
              formData.append("netto", updatedNetto);
              formData.append("warna", updatedWarna);
              formData.append("harga", updatedHarga);
              formData.append("stock", updatedStock);
              formData.append("foto", updatedFoto); // Untuk mengirim foto jika ada

              // Kirim data ke server menggunakan AJAX (jQuery)
              $.ajax({
                url: "/accounts/admin/data_barang/edit_barang", // Ubah URL jika perlu
                method: "POST",
                data: formData,
                contentType: false,
                processData: false,
                success: function (response) {
                  if (response.status === "success") {
                    alert("Barang berhasil diperbarui!");
                    location.reload(); // Reload halaman setelah berhasil
                  } else {
                    alert("Terjadi kesalahan saat memperbarui barang.");
                  }
                },
                error: function () {
                  alert("Terjadi kesalahan saat mengirim data.");
                },
              });
            });
        });
      });

      document.addEventListener("DOMContentLoaded", function () {
        // Inisialisasi tab Bootstrap
        var triggerTabList = [].slice.call(
          document.querySelectorAll(".nav-link")
        );
        triggerTabList.forEach(function (triggerEl) {
          var tabTrigger = new bootstrap.Tab(triggerEl);
          triggerEl.addEventListener("click", function (event) {
            event.preventDefault();
            tabTrigger.show();
          });
        });
      });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
  </body>
</html>
